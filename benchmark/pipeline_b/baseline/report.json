{
  "metadata": {
    "timestamp": "2026-01-30T01:57:04.746141",
    "pipeline": "Pipeline B - Trading Analytics",
    "pipeline_code": "B",
    "complexity_level": "MEDIUM",
    "target_table": "FACT_TRADES",
    "model_count": 12,
    "models": [
      "stg_brokers",
      "stg_securities",
      "stg_trades",
      "stg_market_prices",
      "int_trades_enriched",
      "int_trade_metrics",
      "int_trade_summary",
      "int_security_performance",
      "int_trade_execution_analysis",
      "fact_trades",
      "report_trading_performance",
      "report_trade_performance"
    ]
  },
  "kpi_1_execution": {
    "runtime_seconds": 22.21,
    "description": "End-to-end query execution time"
  },
  "kpi_2_work_metrics": {
    "rows_returned": 21000,
    "bytes_scanned": 3200000,
    "description": "Rows and bytes scanned from Snowflake QUERY_PROFILE"
  },
  "kpi_3_output_validation": {
    "row_count": 21000,
    "output_hash": "36cf307d6e5b03376cb79ad250fa0ebb700359b1b8260906fa2388d414184064",
    "hash_algorithm": "SHA256",
    "description": "Hash for output equivalence checking"
  },
  "kpi_4_complexity": {
    "num_joins": 8,
    "num_ctes": 15,
    "num_window_functions": 5,
    "num_subqueries": 3,
    "complexity_score": 18.5,
    "description": "Query complexity metrics"
  },
  "kpi_5_cost_estimation": {
    "credits_estimated": 0.08884,
    "runtime_seconds": 22.21,
    "warehouse_size": "M",
    "credits_per_second": 4,
    "description": "Estimated Snowflake credits"
  },
  "optimization_opportunities": [
    {
      "rank": 1,
      "issue": "Add index on security_id in stg_trades",
      "expected_improvement": "10-15% join performance"
    },
    {
      "rank": 2,
      "issue": "Materialize int_trades_enriched as incremental model",
      "expected_improvement": "20-30% runtime reduction"
    },
    {
      "rank": 3,
      "issue": "Pre-aggregate broker metrics before fact table join",
      "expected_improvement": "15-20% row reduction"
    },
    {
      "rank": 4,
      "issue": "Push date filters to staging layer",
      "expected_improvement": "25-30% overall improvement"
    }
  ],
  "status": "CANDIDATE"
}