{
  "metadata": {
    "timestamp": "2026-01-30T01:51:20.044830",
    "pipeline": "Pipeline A - Cashflow Analytics",
    "pipeline_code": "A",
    "complexity_level": "LOW",
    "target_table": "FACT_CASHFLOW_SUMMARY",
    "model_count": 4,
    "models": [
      "stg_cashflows",
      "stg_portfolios",
      "int_portfolio_cashflows",
      "fact_cashflow_summary"
    ]
  },
  "kpi_1_execution": {
    "runtime_seconds": 15.34,
    "description": "End-to-end query execution time"
  },
  "kpi_2_work_metrics": {
    "rows_returned": 7000,
    "bytes_scanned": 1400000,
    "description": "Rows and bytes scanned from Snowflake QUERY_PROFILE"
  },
  "kpi_3_output_validation": {
    "row_count": 7000,
    "output_hash": "90073473745c932af80d2946feebd983576d3ef9e6b4a70dfd58ca20937a98a3",
    "hash_algorithm": "SHA256",
    "description": "Hash for output equivalence checking"
  },
  "kpi_4_complexity": {
    "num_joins": 2,
    "num_ctes": 5,
    "num_window_functions": 1,
    "num_subqueries": 1,
    "complexity_score": 8.3,
    "description": "Query complexity metrics"
  },
  "kpi_5_cost_estimation": {
    "credits_estimated": 0.06136,
    "runtime_seconds": 15.34,
    "warehouse_size": "M",
    "credits_per_second": 4,
    "description": "Estimated Snowflake credits"
  },
  "optimization_opportunities": [
    {
      "rank": 1,
      "issue": "Materialize stg_cashflows as incremental model",
      "expected_improvement": "15-20% runtime reduction"
    },
    {
      "rank": 2,
      "issue": "Add partition on cashflow_month in fact table",
      "expected_improvement": "20-25% query improvement"
    }
  ],
  "status": "CANDIDATE"
}