{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.2", "generated_at": "2026-02-03T23:32:22.232902Z", "invocation_id": "38b20c36-c049-476b-836b-a95119e84b27", "invocation_started_at": "2026-02-03T23:32:03.344580Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T23:32:10.494312Z", "completed_at": "2026-02-03T23:32:10.509984Z"}, {"name": "execute", "started_at": "2026-02-03T23:32:10.543819Z", "completed_at": "2026-02-03T23:32:12.598218Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.1198558807373047, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22ce4-0307-ab94-001d-84530005c31e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_securities", "compiled": true, "compiled_code": "-- Pipeline B: Staging Layer\n-- stg_securities.sql\n-- Purpose: Clean security master data\n\n\n\nselect\n    security_id,\n    ticker,\n    security_name,\n    asset_class,\n    sector,\n    current_timestamp() as dbt_loaded_at\nfrom BAIN_ANALYTICS.DEV.sample_securities", "relation_name": "BAIN_ANALYTICS.DEV.stg_securities", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T23:32:10.494312Z", "completed_at": "2026-02-03T23:32:10.509984Z"}, {"name": "execute", "started_at": "2026-02-03T23:32:10.543819Z", "completed_at": "2026-02-03T23:32:12.726152Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.2477900981903076, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22ce4-0307-aa92-001d-84530005e302"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_market_prices", "compiled": true, "compiled_code": "-- Pipeline B: Staging Layer\n-- stg_market_prices.sql\n-- Purpose: Clean market price data\n\n\n\nselect\n    security_id,\n    price_date,\n    close_price,\n    volume,\n    current_timestamp() as dbt_loaded_at\nfrom BAIN_ANALYTICS.DEV.sample_market_prices", "relation_name": "BAIN_ANALYTICS.DEV.stg_market_prices", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T23:32:10.494312Z", "completed_at": "2026-02-03T23:32:10.543819Z"}, {"name": "execute", "started_at": "2026-02-03T23:32:10.543819Z", "completed_at": "2026-02-03T23:32:12.744862Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 2.268505811691284, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22ce4-0307-ab94-001d-84530005c322"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_trades", "compiled": true, "compiled_code": "-- Pipeline B: Staging Layer\n-- stg_trades.sql\n-- Purpose: Clean and standardize trade transaction data\n\n\n\nselect\n    trade_id,\n    portfolio_id,\n    security_id,\n    broker_id,\n    trade_date,\n    trade_type,\n    cast(quantity as numeric(18, 2)) as quantity,\n    cast(price as numeric(18, 2)) as price,\n    cast(net_amount as numeric(18, 2)) as commission,\n    current_timestamp() as dbt_loaded_at\nfrom BAIN_ANALYTICS.DEV.sample_trades\nwhere quantity > 0", "relation_name": "BAIN_ANALYTICS.DEV.stg_trades", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T23:32:10.478362Z", "completed_at": "2026-02-03T23:32:10.509984Z"}, {"name": "execute", "started_at": "2026-02-03T23:32:10.509984Z", "completed_at": "2026-02-03T23:32:12.999055Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.5206925868988037, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22ce4-0307-abc1-001d-84530005f2f2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_brokers", "compiled": true, "compiled_code": "-- Pipeline B: Staging Layer\n-- stg_brokers.sql\n-- Purpose: Clean broker/counterparty data\n\n\n\nselect\n    broker_id,\n    broker_name,\n    current_timestamp() as dbt_loaded_at\nfrom BAIN_ANALYTICS.DEV.sample_brokers", "relation_name": "BAIN_ANALYTICS.DEV.stg_brokers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T23:32:12.999055Z", "completed_at": "2026-02-03T23:32:12.999055Z"}, {"name": "execute", "started_at": "2026-02-03T23:32:12.999055Z", "completed_at": "2026-02-03T23:32:13.766538Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.7674827575683594, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22ce4-0307-abea-001d-845300060316"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.int_trades_enriched", "compiled": true, "compiled_code": "-- Pipeline B: Intermediate Layer\n-- int_trades_enriched.sql\n-- Purpose: Enrich trades with security and broker details\n\n\n\nwith trades as (\n    select * from BAIN_ANALYTICS.DEV.stg_trades\n),\nsecurities as (\n    select * from BAIN_ANALYTICS.DEV.stg_securities\n),\nbrokers as (\n    select * from BAIN_ANALYTICS.DEV.stg_brokers\n)\n\nselect\n    t.trade_id,\n    t.portfolio_id,\n    t.security_id,\n    t.broker_id,\n    t.trade_date,\n    t.trade_type,\n    t.quantity,\n    t.price,\n    t.commission,\n    s.ticker,\n    s.security_name,\n    s.asset_class,\n    s.sector,\n    b.broker_name\nfrom trades t\ninner join securities s on t.security_id = s.security_id\ninner join brokers b on t.broker_id = b.broker_id", "relation_name": "BAIN_ANALYTICS.DEV.int_trades_enriched", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T23:32:13.766538Z", "completed_at": "2026-02-03T23:32:13.766538Z"}, {"name": "execute", "started_at": "2026-02-03T23:32:13.766538Z", "completed_at": "2026-02-03T23:32:14.476816Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.7102780342102051, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22ce4-0307-abea-001d-84530006031a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.int_trade_metrics", "compiled": true, "compiled_code": "-- Pipeline B: Intermediate Layer\n-- int_trade_metrics.sql\n-- Purpose: Calculate trade-level metrics and PnL\n\n\n\nwith enriched as (\n    select * from BAIN_ANALYTICS.DEV.int_trades_enriched\n),\n\ntrade_values as (\n    select\n        trade_id,\n        portfolio_id,\n        security_id,\n        broker_id,\n        trade_date,\n        trade_type,\n        quantity,\n        price,\n        commission,\n        ticker,\n        security_name,\n        asset_class,\n        sector,\n        broker_name,\n        round(quantity * price, 2) as trade_value,\n        round(quantity * price - commission, 2) as net_trade_value,\n        round(case\n            when trade_type = 'BUY' then -1 * (quantity * price)\n            when trade_type = 'SELL' then quantity * price\n            else 0\n        end, 2) as position_impact\n    from enriched\n)\n\nselect\n    trade_id,\n    portfolio_id,\n    security_id,\n    broker_id,\n    trade_date,\n    trade_type,\n    quantity,\n    price,\n    commission,\n    ticker,\n    security_name,\n    asset_class,\n    sector,\n    broker_name,\n    trade_value,\n    net_trade_value,\n    position_impact\nfrom trade_values", "relation_name": "BAIN_ANALYTICS.DEV.int_trade_metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T23:32:14.508477Z", "completed_at": "2026-02-03T23:32:14.522588Z"}, {"name": "execute", "started_at": "2026-02-03T23:32:14.528624Z", "completed_at": "2026-02-03T23:32:15.542784Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 1.0502777099609375, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22ce4-0307-ac15-001d-84530006128a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.int_trade_summary", "compiled": true, "compiled_code": "-- Pipeline B: Intermediate Layer\n-- int_trade_summary.sql\n-- Purpose: Summarize trades by security and date (for aggregation upstream)\n\n\n\nwith metrics as (\n    select * from BAIN_ANALYTICS.DEV.int_trade_metrics\n),\n\nsummary as (\n    select\n        portfolio_id,\n        security_id,\n        trade_date,\n        ticker,\n        security_name,\n        asset_class,\n        sector,\n        broker_name,\n        count(*) as trade_count,\n        sum(quantity) as total_quantity,\n        sum(trade_value) as total_trade_value,\n        sum(commission) as total_commission,\n        avg(price) as avg_price\n    from metrics\n    group by portfolio_id, security_id, trade_date, ticker, security_name, asset_class, sector, broker_name\n)\n\nselect * from summary", "relation_name": "BAIN_ANALYTICS.DEV.int_trade_summary", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T23:32:14.505447Z", "completed_at": "2026-02-03T23:32:14.508477Z"}, {"name": "execute", "started_at": "2026-02-03T23:32:14.524334Z", "completed_at": "2026-02-03T23:32:15.542784Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0502777099609375, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22ce4-0307-ab94-001d-84530005c326"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.int_trade_execution_analysis", "compiled": true, "compiled_code": "-- Pipeline B: Intermediate Layer\n-- int_trade_execution_analysis.sql\n-- Purpose: Advanced trade execution analysis with market impact and execution costs\n\n\n\nwith trades_detail as (\n    select * from BAIN_ANALYTICS.DEV.int_trade_metrics\n),\n\nwith_window_aggregates as (\n    select\n        trade_id,\n        trade_date,\n        portfolio_id,\n        security_id,\n        ticker,\n        quantity,\n        price,\n        price as execution_price,\n        trade_value,\n        commission,\n        round(avg(price) over (partition by trade_date, security_id), 2) as daily_avg_price,\n        min(price) over (partition by trade_date, security_id) as daily_min_price,\n        max(price) over (partition by trade_date, security_id) as daily_max_price,\n        (max(price) over (partition by trade_date, security_id) - min(price) over (partition by trade_date, security_id)) as daily_price_range,\n        round(stddev_pop(price) over (partition by trade_date, security_id), 4) as daily_volatility,\n        round((price - min(price) over (partition by trade_date, security_id)) / nullif((max(price) over (partition by trade_date, security_id) - min(price) over (partition by trade_date, security_id)), 0), 8) as execution_percentile\n    from trades_detail\n)\n\nselect\n    trade_id,\n    trade_date,\n    portfolio_id,\n    security_id,\n    ticker,\n    quantity,\n    execution_price,\n    trade_value,\n    commission,\n    daily_avg_price,\n    daily_min_price,\n    daily_max_price,\n    daily_price_range,\n    daily_volatility,\n    execution_percentile,\n    round(100 * (price - daily_avg_price) / nullif(daily_avg_price, 0), 4) as price_vs_avg_pct,\n    case\n        when execution_percentile > 0.75 then 'POOR'\n        when execution_percentile > 0.50 then 'FAIR'\n        when execution_percentile > 0.25 then 'GOOD'\n        else 'EXCELLENT'\n    end as execution_quality,\n    round(commission / nullif(trade_value, 0), 8) as commission_ratio,\n    round(100 * commission / nullif(trade_value, 0), 6) as commission_ratio_bps\nfrom with_window_aggregates", "relation_name": "BAIN_ANALYTICS.DEV.int_trade_execution_analysis", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T23:32:14.492507Z", "completed_at": "2026-02-03T23:32:14.508477Z"}, {"name": "execute", "started_at": "2026-02-03T23:32:14.508477Z", "completed_at": "2026-02-03T23:32:15.608702Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1161949634552002, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22ce4-0307-ac15-001d-84530006128e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.int_security_performance", "compiled": true, "compiled_code": "-- Pipeline B: Intermediate Layer\n-- int_security_performance.sql\n-- Purpose: Per-security trading performance metrics\n\n\n\nwith trades as (\n    select * from BAIN_ANALYTICS.DEV.int_trade_metrics\n)\n\nselect\n    security_id,\n    ticker,\n    security_name,\n    asset_class,\n    sector,\n    count(*) as security_trade_count,\n    count(distinct portfolio_id) as portfolios_traded,\n    count(distinct broker_id) as brokers_used,\n    sum(quantity) as total_quantity_traded,\n    sum(trade_value) as total_trade_value,\n    avg(price) as avg_trading_price,\n    min(price) as min_trading_price,\n    max(price) as max_trading_price,\n    round(stddev_pop(price), 4) as price_volatility,\n    sum(commission) as total_commissions\nfrom trades\ngroup by security_id, ticker, security_name, asset_class, sector", "relation_name": "BAIN_ANALYTICS.DEV.int_security_performance", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T23:32:14.492507Z", "completed_at": "2026-02-03T23:32:14.508477Z"}, {"name": "execute", "started_at": "2026-02-03T23:32:14.508477Z", "completed_at": "2026-02-03T23:32:15.811946Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.319439172744751, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22ce4-0307-abc1-001d-84530005f2f6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.fact_trades", "compiled": true, "compiled_code": "-- Pipeline B: Fact Layer\n-- fact_trades.sql\n-- Purpose: Detailed trade fact table with all metrics\n\n\n\nselect * from BAIN_ANALYTICS.DEV.int_trade_metrics", "relation_name": "BAIN_ANALYTICS.DEV.fact_trades", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T23:32:15.558294Z", "completed_at": "2026-02-03T23:32:15.573973Z"}, {"name": "execute", "started_at": "2026-02-03T23:32:15.573973Z", "completed_at": "2026-02-03T23:32:16.403231Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.844937801361084, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22ce4-0307-abea-001d-84530006031e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.report_trade_performance", "compiled": true, "compiled_code": "-- Pipeline B: Report Layer\n-- report_trade_performance.sql\n-- Purpose: Comprehensive trade execution and performance analysis\n\n\n\nselect\n    trade_id,\n    trade_date,\n    portfolio_id,\n    security_id,\n    ticker,\n    quantity,\n    execution_price,\n    trade_value,\n    commission,\n    daily_avg_price,\n    execution_percentile,\n    price_vs_avg_pct,\n    execution_quality,\n    commission_ratio_bps\nfrom BAIN_ANALYTICS.DEV.int_trade_execution_analysis", "relation_name": "BAIN_ANALYTICS.DEV.report_trade_performance", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T23:32:15.558294Z", "completed_at": "2026-02-03T23:32:15.558294Z"}, {"name": "execute", "started_at": "2026-02-03T23:32:15.558294Z", "completed_at": "2026-02-03T23:32:16.642641Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 1.0843479633331299, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22ce4-0307-aa92-001d-84530005e306"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.report_trading_performance", "compiled": true, "compiled_code": "-- Pipeline B: Report Layer\n-- report_trading_performance.sql\n-- Purpose: Trading performance summary by portfolio and security\n\n\n\nselect * from BAIN_ANALYTICS.DEV.int_trade_summary", "relation_name": "BAIN_ANALYTICS.DEV.report_trading_performance", "batch_results": null}], "elapsed_time": 17.18934988975525, "args": {"profiles_dir": "I:\\dianababaei\\dbt\\sample-dbt-project", "send_anonymous_usage_stats": true, "state_modified_compare_vars": false, "quiet": false, "log_level": "info", "log_path": "I:\\dianababaei\\dbt\\sample-dbt-project\\logs", "introspect": true, "write_json": true, "require_generic_test_arguments_property": true, "partial_parse": true, "require_explicit_package_overrides_for_builtin_materializations": true, "show_all_deprecations": false, "favor_state": false, "export_saved_queries": false, "require_resource_names_without_spaces": true, "require_yaml_configuration_for_mf_time_spines": false, "skip_nodes_if_on_run_start_fails": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "invocation_command": "dbt build --select tag:pipeline_b", "use_colors": true, "log_file_max_bytes": 10485760, "strict_mode": false, "require_nested_cumulative_type_params": false, "macro_debugging": false, "indirect_selection": "eager", "printer_width": 80, "include_saved_query": false, "log_level_file": "debug", "which": "build", "defer": false, "vars": {}, "empty": false, "state_modified_compare_more_unrendered_values": false, "use_fast_test_edges": false, "print": true, "require_batched_execution_for_custom_microbatch_strategy": false, "show": false, "show_resource_report": false, "require_ref_searches_node_package_before_root": false, "select": ["tag:pipeline_b"], "log_format": "default", "validate_macro_args": false, "log_format_file": "debug", "source_freshness_run_project_hooks": true, "exclude_resource_types": [], "exclude": [], "require_all_warnings_handled_by_warn_error": false, "partial_parse_file_diff": true, "version_check": true, "use_colors_file": true, "project_dir": "I:\\dianababaei\\dbt\\sample-dbt-project", "cache_selected_only": false, "resource_types": [], "populate_cache": true, "static_parser": true, "require_unique_project_resource_names": false, "upload_to_artifacts_ingest_api": false}}