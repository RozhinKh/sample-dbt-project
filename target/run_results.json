{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.4", "generated_at": "2026-02-11T08:06:15.897960Z", "invocation_id": "0de0ff83-f3c7-4c67-9877-e59e2271bf05", "invocation_started_at": "2026-02-11T08:05:18.533573Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T08:05:26.686239Z", "completed_at": "2026-02-11T08:05:26.691238Z"}, {"name": "execute", "started_at": "2026-02-11T08:05:26.692239Z", "completed_at": "2026-02-11T08:05:29.091274Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.322115659713745, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25645-0307-c05e-001d-934300086066"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_brokers", "compiled": true, "compiled_code": "-- Pipeline B: Staging Layer\n-- stg_brokers.sql\n-- Purpose: Clean broker/counterparty data\n\n\n\nselect\n    broker_id,\n    broker_name,\n    current_timestamp() as dbt_loaded_at\nfrom BAIN_ANALYTICS.DEV.sample_brokers", "relation_name": "BAIN_ANALYTICS.DEV.stg_brokers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T08:05:30.011362Z", "completed_at": "2026-02-11T08:05:30.014354Z"}, {"name": "execute", "started_at": "2026-02-11T08:05:30.015359Z", "completed_at": "2026-02-11T08:05:32.064209Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.5917062759399414, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25645-0307-c05e-001d-93430008606a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_market_prices", "compiled": true, "compiled_code": "-- Pipeline B: Staging Layer\n-- stg_market_prices.sql\n-- Purpose: Clean market price data\n\n\n\nselect\n    security_id,\n    price_date,\n    close_price,\n    volume,\n    current_timestamp() as dbt_loaded_at\nfrom BAIN_ANALYTICS.DEV.sample_market_prices", "relation_name": "BAIN_ANALYTICS.DEV.stg_market_prices", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T08:05:33.608489Z", "completed_at": "2026-02-11T08:05:33.614483Z"}, {"name": "execute", "started_at": "2026-02-11T08:05:33.615483Z", "completed_at": "2026-02-11T08:05:36.937189Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 4.151297569274902, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25645-0307-bfb0-001d-93430008801e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_securities", "compiled": true, "compiled_code": "-- Pipeline B: Staging Layer\n-- stg_securities.sql\n-- Purpose: Clean security master data\n\n\n\nselect\n    security_id,\n    ticker,\n    security_name,\n    asset_class,\n    sector,\n    current_timestamp() as dbt_loaded_at\nfrom BAIN_ANALYTICS.DEV.sample_securities", "relation_name": "BAIN_ANALYTICS.DEV.stg_securities", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T08:05:37.765766Z", "completed_at": "2026-02-11T08:05:37.770768Z"}, {"name": "execute", "started_at": "2026-02-11T08:05:37.771767Z", "completed_at": "2026-02-11T08:05:43.410637Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 6.2459728717803955, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25645-0307-c05e-001d-93430008606e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_trades", "compiled": true, "compiled_code": "-- Pipeline B: Staging Layer\n-- stg_trades.sql\n-- Purpose: Clean and standardize trade transaction data\n\n\n\nselect\n    trade_id,\n    portfolio_id,\n    security_id,\n    broker_id,\n    trade_date,\n    trade_type,\n    cast(quantity as numeric(18, 2)) as quantity,\n    cast(price as numeric(18, 2)) as price,\n    cast(net_amount as numeric(18, 2)) as commission,\n    current_timestamp() as dbt_loaded_at\nfrom BAIN_ANALYTICS.DEV.sample_trades\nwhere quantity > 0", "relation_name": "BAIN_ANALYTICS.DEV.stg_trades", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T08:05:44.016431Z", "completed_at": "2026-02-11T08:05:44.022861Z"}, {"name": "execute", "started_at": "2026-02-11T08:05:44.023861Z", "completed_at": "2026-02-11T08:05:46.115178Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.7256970405578613, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25645-0307-c05e-001d-934300086072"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.int_trades_enriched", "compiled": true, "compiled_code": "-- Pipeline B: Intermediate Layer\n-- int_trades_enriched.sql\n-- Purpose: Enrich trades with security and broker details\n\n\n\nwith trades as (\n    select * from BAIN_ANALYTICS.DEV.stg_trades\n),\nsecurities as (\n    select * from BAIN_ANALYTICS.DEV.stg_securities\n),\nbrokers as (\n    select * from BAIN_ANALYTICS.DEV.stg_brokers\n)\n\nselect\n    t.trade_id,\n    t.portfolio_id,\n    t.security_id,\n    t.broker_id,\n    t.trade_date,\n    t.trade_type,\n    t.quantity,\n    t.price,\n    t.commission,\n    s.ticker,\n    s.security_name,\n    s.asset_class,\n    s.sector,\n    b.broker_name\nfrom trades t\ninner join securities s on t.security_id = s.security_id\ninner join brokers b on t.broker_id = b.broker_id", "relation_name": "BAIN_ANALYTICS.DEV.int_trades_enriched", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T08:05:46.750056Z", "completed_at": "2026-02-11T08:05:46.757057Z"}, {"name": "execute", "started_at": "2026-02-11T08:05:46.758058Z", "completed_at": "2026-02-11T08:05:49.161087Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.572218656539917, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25645-0307-be24-001d-93430008108e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.int_trade_metrics", "compiled": true, "compiled_code": "-- Pipeline B: Intermediate Layer\n-- int_trade_metrics.sql\n-- Purpose: Calculate trade-level metrics and PnL\n\n\n\nwith enriched as (\n    select * from BAIN_ANALYTICS.DEV.int_trades_enriched\n),\n\ncast_enriched as (\n    select\n        trade_id,\n        portfolio_id,\n        security_id,\n        broker_id,\n        trade_date,\n        trade_type,\n        cast(quantity as numeric(18, 2)) as quantity,\n        cast(price as numeric(18, 2)) as price,\n        cast(commission as numeric(18, 2)) as commission,\n        ticker,\n        security_name,\n        asset_class,\n        sector,\n        broker_name\n    from enriched\n),\n\ntrade_values as (\n    select\n        trade_id,\n        portfolio_id,\n        security_id,\n        broker_id,\n        trade_date,\n        trade_type,\n        quantity,\n        price,\n        commission,\n        ticker,\n        security_name,\n        asset_class,\n        sector,\n        broker_name,\n        round(quantity * price, 2) as trade_value,\n        round(quantity * price - commission, 2) as net_trade_value,\n        round(case\n            when trade_type = 'BUY' then -1 * (quantity * price)\n            when trade_type = 'SELL' then quantity * price\n            else 0\n        end, 2) as position_impact\n    from cast_enriched\n)\n\nselect\n    trade_id,\n    portfolio_id,\n    security_id,\n    broker_id,\n    trade_date,\n    trade_type,\n    quantity,\n    price,\n    commission,\n    ticker,\n    security_name,\n    asset_class,\n    sector,\n    broker_name,\n    trade_value,\n    net_trade_value,\n    position_impact\nfrom trade_values", "relation_name": "BAIN_ANALYTICS.DEV.int_trade_metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T08:05:50.325437Z", "completed_at": "2026-02-11T08:05:50.331958Z"}, {"name": "execute", "started_at": "2026-02-11T08:05:50.332959Z", "completed_at": "2026-02-11T08:05:52.955991Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.4648821353912354, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25645-0307-bf4e-001d-9343000800da"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.fact_trades", "compiled": true, "compiled_code": "-- Pipeline B: Fact Layer\n-- fact_trades.sql\n-- Purpose: Detailed trade fact table with all metrics\n\n\n\nselect * from BAIN_ANALYTICS.DEV.int_trade_metrics", "relation_name": "BAIN_ANALYTICS.DEV.fact_trades", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T08:05:53.792038Z", "completed_at": "2026-02-11T08:05:53.795124Z"}, {"name": "execute", "started_at": "2026-02-11T08:05:53.796047Z", "completed_at": "2026-02-11T08:05:57.621412Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 4.746617078781128, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25645-0307-bfb0-001d-934300088022"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.int_security_performance", "compiled": true, "compiled_code": "-- Pipeline B: Intermediate Layer\n-- int_security_performance.sql\n-- Purpose: Per-security trading performance metrics\n\n\n\nwith trades as (\n    select * from BAIN_ANALYTICS.DEV.int_trade_metrics\n)\n\nselect\n    security_id,\n    ticker,\n    security_name,\n    asset_class,\n    sector,\n    count(*) as security_trade_count,\n    count(distinct portfolio_id) as portfolios_traded,\n    count(distinct broker_id) as brokers_used,\n    sum(quantity) as total_quantity_traded,\n    sum(trade_value) as total_trade_value,\n    avg(price) as avg_trading_price,\n    min(price) as min_trading_price,\n    max(price) as max_trading_price,\n    round(stddev_pop(price), 4) as price_volatility,\n    sum(commission) as total_commissions\nfrom trades\ngroup by security_id, ticker, security_name, asset_class, sector", "relation_name": "BAIN_ANALYTICS.DEV.int_security_performance", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T08:05:58.540164Z", "completed_at": "2026-02-11T08:05:58.544715Z"}, {"name": "execute", "started_at": "2026-02-11T08:05:58.545720Z", "completed_at": "2026-02-11T08:06:01.330446Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.393190383911133, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25645-0307-be90-001d-93430007e0c6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.int_trade_execution_analysis", "compiled": true, "compiled_code": "-- Pipeline B: Intermediate Layer\n-- int_trade_execution_analysis.sql\n-- Purpose: Advanced trade execution analysis with market impact and execution costs\n\n\n\nwith trades_detail as (\n    select * from BAIN_ANALYTICS.DEV.int_trade_metrics\n),\n\nmarket_context as (\n    select\n        trade_date,\n        security_id,\n        avg(price) as daily_avg_price,\n        min(price) as daily_min_price,\n        max(price) as daily_max_price,\n        max(price) - min(price) as daily_price_range,\n        stddev_pop(price) as daily_volatility\n    from trades_detail\n    group by 1, 2\n)\n\nselect\n    td.trade_id,\n    td.trade_date,\n    td.portfolio_id,\n    td.security_id,\n    td.ticker,\n    td.quantity,\n    td.price as execution_price,\n    td.trade_value,\n    td.commission,\n    mc.daily_avg_price,\n    mc.daily_min_price,\n    mc.daily_max_price,\n    mc.daily_price_range,\n    mc.daily_volatility,\n    round((td.price - mc.daily_min_price) / nullif(mc.daily_price_range, 0), 8) as execution_percentile,\n    round(100 * (td.price - mc.daily_avg_price) / nullif(mc.daily_avg_price, 0), 4) as price_vs_avg_pct,\n    case\n        when (td.price - mc.daily_min_price) / nullif(mc.daily_price_range, 0) > 0.75 then 'POOR'\n        when (td.price - mc.daily_min_price) / nullif(mc.daily_price_range, 0) > 0.50 then 'FAIR'\n        when (td.price - mc.daily_min_price) / nullif(mc.daily_price_range, 0) > 0.25 then 'GOOD'\n        else 'EXCELLENT'\n    end as execution_quality,\n    round(td.commission / nullif(td.trade_value, 0), 8) as commission_ratio,\n    round(100 * td.commission / nullif(td.trade_value, 0), 6) as commission_ratio_bps\nfrom trades_detail td\njoin market_context mc\n    on td.security_id = mc.security_id\n    and td.trade_date = mc.trade_date", "relation_name": "BAIN_ANALYTICS.DEV.int_trade_execution_analysis", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T08:06:01.938367Z", "completed_at": "2026-02-11T08:06:01.944879Z"}, {"name": "execute", "started_at": "2026-02-11T08:06:01.945896Z", "completed_at": "2026-02-11T08:06:05.803807Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 4.652161359786987, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25646-0307-bf4e-001d-9343000800de"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.int_trade_summary", "compiled": true, "compiled_code": "-- Pipeline B: Intermediate Layer\n-- int_trade_summary.sql\n-- Purpose: Summarize trades by security and date (for aggregation upstream)\n\n\n\nwith metrics as (\n    select * from BAIN_ANALYTICS.DEV.int_trade_metrics\n),\n\nsummary as (\n    select\n        portfolio_id,\n        security_id,\n        trade_date,\n        ticker,\n        security_name,\n        asset_class,\n        sector,\n        broker_name,\n        count(*) as trade_count,\n        sum(quantity) as total_quantity,\n        sum(trade_value) as total_trade_value,\n        sum(commission) as total_commission,\n        avg(price) as avg_price\n    from metrics\n    group by portfolio_id, security_id, trade_date, ticker, security_name, asset_class, sector, broker_name\n)\n\nselect * from summary", "relation_name": "BAIN_ANALYTICS.DEV.int_trade_summary", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T08:06:06.596541Z", "completed_at": "2026-02-11T08:06:06.602541Z"}, {"name": "execute", "started_at": "2026-02-11T08:06:06.603542Z", "completed_at": "2026-02-11T08:06:09.258658Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.638950824737549, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25646-0307-be24-001d-934300081092"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.report_trade_performance", "compiled": true, "compiled_code": "-- Pipeline B: Report Layer\n-- report_trade_performance.sql\n-- Purpose: Comprehensive trade execution and performance analysis\n\n\n\nselect\n    trade_id,\n    trade_date,\n    portfolio_id,\n    security_id,\n    ticker,\n    quantity,\n    execution_price,\n    trade_value,\n    commission,\n    daily_avg_price,\n    execution_percentile,\n    price_vs_avg_pct,\n    execution_quality,\n    commission_ratio_bps\nfrom BAIN_ANALYTICS.DEV.int_trade_execution_analysis", "relation_name": "BAIN_ANALYTICS.DEV.report_trade_performance", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T08:06:10.254263Z", "completed_at": "2026-02-11T08:06:10.267168Z"}, {"name": "execute", "started_at": "2026-02-11T08:06:10.270773Z", "completed_at": "2026-02-11T08:06:14.403951Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 5.624702453613281, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c25646-0307-bc54-001d-934300083066"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.report_trading_performance", "compiled": true, "compiled_code": "-- Pipeline B: Report Layer\n-- report_trading_performance.sql\n-- Purpose: Trading performance summary by portfolio and security\n\n\n\nselect * from BAIN_ANALYTICS.DEV.int_trade_summary", "relation_name": "BAIN_ANALYTICS.DEV.report_trading_performance", "batch_results": null}], "elapsed_time": 56.04387354850769, "args": {"upload_to_artifacts_ingest_api": false, "partial_parse": true, "require_all_warnings_handled_by_warn_error": false, "use_fast_test_edges": false, "log_level_file": "debug", "require_unique_project_resource_names": false, "project_dir": "c:\\Users\\BiaDigi\\sample-dbt-project", "send_anonymous_usage_stats": true, "use_colors": true, "quiet": false, "show_all_deprecations": false, "select": ["tag:pipeline_b"], "static_parser": true, "empty": false, "log_path": "c:\\Users\\BiaDigi\\sample-dbt-project\\logs", "macro_debugging": false, "version_check": true, "partial_parse_file_diff": true, "populate_cache": true, "require_nested_cumulative_type_params": false, "exclude": [], "write_json": true, "show_resource_report": false, "introspect": true, "favor_state": false, "strict_mode": false, "require_explicit_package_overrides_for_builtin_materializations": true, "log_format": "default", "validate_macro_args": false, "log_format_file": "debug", "print": true, "printer_width": 80, "require_batched_execution_for_custom_microbatch_strategy": false, "log_file_max_bytes": 10485760, "require_ref_searches_node_package_before_root": false, "require_resource_names_without_spaces": true, "use_colors_file": true, "vars": {}, "cache_selected_only": false, "skip_nodes_if_on_run_start_fails": false, "log_level": "info", "source_freshness_run_project_hooks": true, "require_yaml_configuration_for_mf_time_spines": false, "state_modified_compare_more_unrendered_values": false, "defer": false, "which": "run", "warn_error_options": {"error": [], "warn": [], "silence": []}, "invocation_command": "dbt run --select tag:pipeline_b", "require_generic_test_arguments_property": true, "profiles_dir": "c:\\Users\\BiaDigi\\sample-dbt-project", "state_modified_compare_vars": false, "indirect_selection": "eager"}}